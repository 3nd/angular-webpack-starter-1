{"version":3,"file":"/Users/qdouble/Sites/EXAMPLE_APPS/a2-webpack2-aot-lazy-loading/webpack.config.ts","sources":["/Users/qdouble/Sites/EXAMPLE_APPS/a2-webpack2-aot-lazy-loading/webpack.config.ts"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable: variable-name max-line-length */\nimport 'ts-helpers';\nimport { DEV_PORT } from './constants';\n\nconst {\n  DefinePlugin,\n  ProgressPlugin,\n  NoErrorsPlugin,\n  optimize: {\n    CommonsChunkPlugin\n  }\n} = require('webpack');\n\nconst CompressionPlugin = require('compression-webpack-plugin');\nconst CopyWebpackPlugin = require('copy-webpack-plugin');\nconst {ForkCheckerPlugin} = require('awesome-typescript-loader');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\nconst NamedModulesPlugin = require('webpack/lib/NamedModulesPlugin');\nconst UglifyJsPlugin = require('webpack/lib/optimize/UglifyJsPlugin');\n\nconst path = require('path');\n\nfunction root(__path = '.') {\n  return path.join(__dirname, __path);\n}\n\nconst ENV = process.env.npm_lifecycle_event;\nconst AOT = ENV === 'build:aot' || ENV === 'server:aot' || ENV === 'watch:aot';\nconst isProd = ENV === 'build:prod' || ENV === 'server:prod' || ENV === 'watch:prod' ||  ENV === 'build:aot';\n\n// type definition for WebpackConfig at the bottom\nmodule.exports = function webpackConfig(): WebpackConfig {\n\n  const CONSTANTS = {\n    ENV: isProd ? JSON.stringify('production') : JSON.stringify('development'),\n    PORT: DEV_PORT,\n    HOST: 'localhost'\n  };\n\n  let config: WebpackConfig = Object.assign({});\n\n  config.cache = true;\n  isProd ? config.devtool = 'source-map' : config.devtool = 'eval';\n\n  if (AOT) {\n    config.entry = {\n      main: './src/main.browser.aot'\n    };\n  } else {\n    config.entry = {\n      main: './src/main.browser'\n    };\n  }\n\n  config.output = {\n    path: root('dist'),\n    filename: isProd ? '[name].[hash].bundle.js' : '[name].bundle.js',\n    sourceMapFilename: isProd ? '[name].[hash].map' : '[name].map',\n    chunkFilename: isProd ? '[id].[hash].chunk.js' : '[id].chunk.js'\n  };\n\n  config.module = {\n    preLoaders: [\n      {\n        test: /\\.js$/,\n        loader: 'source-map-loader',\n        exclude: [\n          // these packages have problems with their sourcemaps\n          root('node_modules/rxjs'),\n          root('node_modules/@angular')\n        ]\n      },\n    ],\n\n    loaders: [\n      {\n        test: /\\.ts$/,\n        loaders: [\n          'awesome-typescript-loader',\n          'angular2-template-loader'\n        ],\n        exclude: [/\\.(spec|e2e|d)\\.ts$/]\n      },\n      { test: /\\.json$/, loader: 'json-loader' },\n      { test: /\\.html/, loader: 'raw-loader', exclude: [root('src/index.html')] },\n      { test: /\\.css$/, loader: 'raw-loader' },\n      {\n        test: /\\.scss$/,\n        exclude: /node_modules/,\n        loaders: ['raw-loader', 'sass-loader'] // sass-loader not scss-loader\n      },\n    ]\n  };\n\n  config.plugins = [\n    new ProgressPlugin(),\n    new ForkCheckerPlugin(),\n    new CommonsChunkPlugin({ name: ['main'], minChunks: Infinity }),\n    new DefinePlugin(CONSTANTS),\n    new NamedModulesPlugin(),\n    new CopyWebpackPlugin([{\n      from: 'src/assets',\n      to: 'assets'\n    }]),\n    new HtmlWebpackPlugin({\n      template: 'src/index.html'\n    })\n  ];\n\n  // Add build specific plugins\n  console.log('PRODUCTION BUILD = ', isProd);\n  if (isProd) {\n    config.plugins.push(\n      // Reference: http://webpack.github.io/docs/list-of-plugins.html#noerrorsplugin\n      // Only emit files when there are no errors\n      new NoErrorsPlugin(),\n\n      // Reference: http://webpack.github.io/docs/list-of-plugins.html#uglifyjsplugin\n      // Minify all javascript, switch loaders to minimizing mode\n      new UglifyJsPlugin({\n        beautify: false,\n        comments: false\n      }),\n      new CompressionPlugin({\n        asset: '[path].gz[query]',\n        algorithm: 'gzip',\n        test: /\\.js$|\\.html$/,\n        threshold: 10240,\n        minRatio: 0.8\n      })\n    );\n    config.resolve = {\n      extensions: ['.ts', '.js'],\n      root: root('src'),\n      moduleDirectories: ['node_modules'],\n      mainFields: ['module', 'main', 'browser']\n    };\n  } else {\n    config.resolve = {\n      extensions: ['.ts', '.js'],\n      root: root('src'),\n      moduleDirectories: ['node_modules']\n    };\n  }\n\n  config.devServer = {\n    contentBase: AOT ? './src/compiled' : './src',\n    port: CONSTANTS.PORT,\n    historyApiFallback: true\n  };\n\n  config.node = {\n    global: 'window',\n    process: true,\n    Buffer: false,\n    crypto: 'empty',\n    module: false,\n    clearImmediate: false,\n    setImmediate: false,\n    clearTimeout: true,\n    setTimeout: true\n  };\n\n  return config;\n\n} ();\n\n// // Types\ninterface WebpackConfig {\n    cache?: boolean;\n    target?: string;\n    devtool?: string;\n    entry: any;\n    output: any;\n    module?: any;\n    plugins?: Array<any>;\n    resolve?: {\n      root?: string;\n      extensions?: Array<string>;\n      moduleDirectories?: Array<string>;\n      mainFields?: Array<string>;\n    };\n    devServer?: {\n      contentBase?: string;\n      port?: number;\n      historyApiFallback?: boolean;\n      hot?: boolean;\n      inline?: boolean;\n    };\n    node?: {\n      process?: boolean;\n      global?: boolean | string;\n      Buffer?: boolean;\n      crypto?: string | boolean;\n      module?: boolean;\n      clearImmediate?: boolean;\n      setImmediate?: boolean\n      clearTimeout?: boolean;\n      setTimeout?: boolean\n    };\n}\n"]}